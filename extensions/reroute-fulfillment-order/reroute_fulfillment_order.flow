d2601cd12de582ebb98a760ef3408a06705c58d9de254ca7b6a95c4f4823f917:{"__metadata":{"version":0.1},"root":{"steps":[{"step_id":"7564b200-3b19-11f0-9d20-032c26a29273","step_position":[1240,360],"config_field_values":[{"config_field_id":"method","value":"POST"},{"config_field_id":"url","value":"https://{{shop.myshopifyDomain}}/admin/api/unstable/graphql.json"},{"config_field_id":"headers","value":"[[\"X-Shopify-Access-Token\",\"{{secrets.ShopifyAdmin}}\"],[\"Content-Type\",\"application/json\"]]"},{"config_field_id":"body","value":"{\n\"variables\":{\n\"fulfillmentOrderIds\":[\"{{fulfillmentOrdersForeachitem.id}}\"],\n\"includedLocationIds\":[],\n\"excludedLocationIds\":[]\n},\n\"query\":\"mutation fulfillmentOrdersReroute($excludedLocationIds: [ID!], $fulfillmentOrderIds: [ID!]!, $includedLocationIds: [ID!]) {\\n  fulfillmentOrdersReroute(excludedLocationIds: $excludedLocationIds, fulfillmentOrderIds: $fulfillmentOrderIds, includedLocationIds: $includedLocationIds) {\\n    movedFulfillmentOrders {\\n      id \\n      status\\n      requestStatus\\n      assignedLocation {\\n        location {\\n            id\\n        }\\n      }\\n    }\\n    userErrors {\\n      field\\n      message\\n    }\\n  }\\n}\"\n}"},{"config_field_id":"on_client_error","value":"fail"},{"config_field_id":"on_server_error","value":"retry"}],"task_id":"shopify::flow::send_http","task_version":"2.0","task_type":"ACTION","description":"fulfillmentOrdersReroute","note":null,"name":"Send HTTP request"},{"step_id":"01971c86-2949-766c-95fc-b8a9400f7b49","step_position":[-480,-180],"config_field_values":[],"task_id":"398612a9-4620-4208-92ee-1ff967c5ec61","task_version":"draft","task_type":"TRIGGER","description":null,"note":null,"name":null},{"step_id":"16e9dc50-3ca9-11f0-a8a1-21c109fe5a4c","step_position":[-80,-40],"config_field_values":[{"config_field_id":"input","value":"query {\n  shop {\n    name\n  }\n  fulfillmentOrderId\n  order {\n    fulfillmentOrders {\n      id\n      status\n      requestStatus\n      supportedActions {\n        action\n      }\n    }\n  }\n}\n"},{"config_field_id":"script","value":"export default function main(...args) {\n  console.log(\"Args: \", args);\n  const [input] = args;\n  const fulfillmentOrder = input.order.fulfillmentOrders.find(\n    (f) =>\n      new String(f.id).trim().toLowerCase() ===\n      new String(input.fulfillmentOrderId).trim().toLowerCase(),\n  );\n  return {\n    fulfillmentOrder: {\n      id: fulfillmentOrder.id\n    },\n  };\n}\n"},{"config_field_id":"output_schema","value":"type FulfillmentOrder {\n  id: ID!\n}\n\ntype Output {\n  fulfillmentOrder: FulfillmentOrder\n}\n"}],"task_id":"shopify::flow::run_code","task_version":"0.1","task_type":"ACTION","description":"Map the target fulfillment order","note":null,"name":"Run code"},{"step_id":"94489980-3cad-11f0-a8a1-21c109fe5a4c","step_position":[2200,600],"config_field_values":[{"config_field_id":"fulfillment_order_id","value":"fulfillmentOrdersForeachitem.id"},{"config_field_id":"message","value":""},{"config_field_id":"notify_customer","value":"false"}],"task_id":"shopify::admin::fulfillment_order_submit_fulfillment_request","task_version":"0.1","task_type":"ACTION","description":null,"note":null,"name":null},{"step_id":"dd57d240-3cb6-11f0-a8a1-21c109fe5a4c","step_position":[340,100],"config_field_values":[{"config_field_id":"listpath","value":"order.fulfillmentOrders"}],"task_id":"shopify::flow::foreach","task_version":"0.1","task_type":"FOREACH","description":null,"note":null,"name":null},{"step_id":"edbb60c0-3cb6-11f0-a8a1-21c109fe5a4c","step_position":[780,240],"config_field_values":[{"config_field_id":"condition","value":"{\"uuid\":\"f3b78352-3cb6-11f0-a8a1-21c109fe5a4c\",\"lhs\":{\"uuid\":\"f0a931e0-3cb6-11f0-a8a1-21c109fe5a4c\",\"parent_uuid\":\"f3b78352-3cb6-11f0-a8a1-21c109fe5a4c\",\"lhs\":{\"uuid\":\"f3b78350-3cb6-11f0-a8a1-21c109fe5a4c\",\"parent_uuid\":\"f0a931e0-3cb6-11f0-a8a1-21c109fe5a4c\",\"value\":\"runCode.fulfillmentOrder.id\",\"comparison_value_type\":\"EnvironmentValue\",\"full_environment_path\":\"runCode.fulfillmentOrder.id\"},\"rhs\":{\"uuid\":\"f8702960-3cb6-11f0-a8a1-21c109fe5a4c\",\"parent_uuid\":\"f0a931e0-3cb6-11f0-a8a1-21c109fe5a4c\",\"value\":\"fulfillmentOrdersForeachitem.id\",\"comparison_value_type\":\"EnvironmentValue\"},\"value_type\":\"EnvironmentScalarDefinition:ID\",\"operator\":\"==\",\"operation_type\":\"Comparison\"},\"operator\":\"AND\",\"operation_type\":\"LogicalExpression\"}"}],"task_id":"shopify::flow::condition","task_version":"0.1","task_type":"CONDITION","description":null,"note":null,"name":null},{"step_id":"84a41ed0-3cb9-11f0-a8a1-21c109fe5a4c","step_position":[1740,480],"config_field_values":[{"config_field_id":"condition","value":"{\"uuid\":\"9ea06022-3cd0-11f0-88ba-3dbdc318c3a6\",\"lhs\":{\"uuid\":\"8bedd000-3cb9-11f0-a8a1-21c109fe5a4c\",\"parent_uuid\":\"9ea06022-3cd0-11f0-88ba-3dbdc318c3a6\",\"array_path\":{\"uuid\":\"8bedd001-3cb9-11f0-a8a1-21c109fe5a4c\",\"parent_uuid\":\"8bedd000-3cb9-11f0-a8a1-21c109fe5a4c\",\"value\":\"fulfillmentOrdersForeachitem.supportedActions\",\"comparison_value_type\":\"EnvironmentValue\"},\"array_item_key\":{\"uuid\":\"8bedd002-3cb9-11f0-a8a1-21c109fe5a4c\",\"parent_uuid\":\"8bedd000-3cb9-11f0-a8a1-21c109fe5a4c\",\"value\":\"supportedActions_item\",\"comparison_value_type\":\"EnvironmentValue\"},\"operation\":{\"uuid\":\"8bedd003-3cb9-11f0-a8a1-21c109fe5a4c\",\"parent_uuid\":\"8bedd000-3cb9-11f0-a8a1-21c109fe5a4c\",\"lhs\":{\"uuid\":\"8bedd004-3cb9-11f0-a8a1-21c109fe5a4c\",\"parent_uuid\":\"8bedd003-3cb9-11f0-a8a1-21c109fe5a4c\",\"lhs\":{\"uuid\":\"8bedd005-3cb9-11f0-a8a1-21c109fe5a4c\",\"parent_uuid\":\"8bedd004-3cb9-11f0-a8a1-21c109fe5a4c\",\"value\":\"supportedActions_item.action\",\"comparison_value_type\":\"EnvironmentValue\",\"full_environment_path\":\"supportedActions_item.action\"},\"rhs\":{\"uuid\":\"908c5e60-3cb9-11f0-a8a1-21c109fe5a4c\",\"parent_uuid\":\"8bedd004-3cb9-11f0-a8a1-21c109fe5a4c\",\"value\":\"REQUEST_FULFILLMENT\",\"comparison_value_type\":\"LiteralValue\"},\"value_type\":\"EnvironmentEnumDefinition:FulfillmentOrderAction\",\"operator\":\"==\",\"operation_type\":\"Comparison\"},\"operator\":\"AND\",\"operation_type\":\"LogicalExpression\"},\"operator\":\"ANY\",\"operation_type\":\"ArrayExpression\"},\"operator\":\"AND\",\"operation_type\":\"LogicalExpression\"}"}],"task_id":"shopify::flow::condition","task_version":"0.1","task_type":"CONDITION","description":null,"note":null,"name":null},{"step_id":"076c0a30-3cba-11f0-a8a1-21c109fe5a4c","step_position":[1740,740],"config_field_values":[{"config_field_id":"order_id","value":"order.id"},{"config_field_id":"metafield","value":"{\"namespace\":\"flow_meta\",\"key\":\"reroute_attempts\",\"type\":\"number_integer\"}"},{"config_field_id":"value","value":"{{order.rerouteAttempts.value | plus: 1}}"}],"task_id":"shopify::admin::add_order_metafield","task_version":"1.0","task_type":"ACTION","description":null,"note":null,"name":null}],"links":[{"from_step_id":"01971c86-2949-766c-95fc-b8a9400f7b49","from_port_id":"output","to_step_id":"16e9dc50-3ca9-11f0-a8a1-21c109fe5a4c","to_port_id":"input"},{"from_step_id":"16e9dc50-3ca9-11f0-a8a1-21c109fe5a4c","from_port_id":"output","to_step_id":"dd57d240-3cb6-11f0-a8a1-21c109fe5a4c","to_port_id":"input"},{"from_step_id":"dd57d240-3cb6-11f0-a8a1-21c109fe5a4c","from_port_id":"loop_body","to_step_id":"edbb60c0-3cb6-11f0-a8a1-21c109fe5a4c","to_port_id":"input"},{"from_step_id":"edbb60c0-3cb6-11f0-a8a1-21c109fe5a4c","from_port_id":"true","to_step_id":"7564b200-3b19-11f0-9d20-032c26a29273","to_port_id":"input"},{"from_step_id":"7564b200-3b19-11f0-9d20-032c26a29273","from_port_id":"output","to_step_id":"84a41ed0-3cb9-11f0-a8a1-21c109fe5a4c","to_port_id":"input"},{"from_step_id":"84a41ed0-3cb9-11f0-a8a1-21c109fe5a4c","from_port_id":"true","to_step_id":"94489980-3cad-11f0-a8a1-21c109fe5a4c","to_port_id":"input"},{"from_step_id":"7564b200-3b19-11f0-9d20-032c26a29273","from_port_id":"output","to_step_id":"076c0a30-3cba-11f0-a8a1-21c109fe5a4c","to_port_id":"input"}],"patched_fields":[{"id":"73075790-3cba-11f0-a8a1-21c109fe5a4c","handle":"rerouteAttempts","field":"metafield","patched_type":"Order","arguments":"{\"key\":\"reroute_attempts\",\"namespace\":\"flow_meta\"}","merchant_configured":true}],"workflow_name":"Reroute Fulfillment Order"}}